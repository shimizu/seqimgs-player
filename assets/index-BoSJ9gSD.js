var u=n=>{throw TypeError(n)};var v=(n,e,t)=>e.has(n)||u("Cannot "+t);var m=(n,e,t)=>e.has(n)?u("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t);var o=(n,e,t)=>(v(n,e,"access private method"),t);function O(){import.meta.url,import("_").catch(()=>1),(async function*(){})().next()}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))h(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&h(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function h(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}})();const c={extension:"jpeg",interval:100,loop:!0,publicPath:"/imgs/",autoPlay:!0};var i,g,f,l,y,I,P,w,E,b;class x{constructor(e){m(this,i);if(this.options=o(this,i,P).call(this,e),o(this,i,w).call(this,this.options),this.mountEl=document.getElementById(this.options.mountId),!this.mountEl)throw new Error('mountId="'.concat(this.options.mountId,'" の要素が見つかりません。'));this.imageEl=document.createElement("img"),this.imageEl.decoding="async",this.imageEl.loading="eager",this.mountEl.innerHTML="",this.mountEl.appendChild(this.imageEl),this.currentIndex=0,this.isPlaying=!1,this.isReady=!1,this.timerId=null,this.preloadPromise=null,this.preloadedImages=[],this.options.autoPlay&&this.preload().then(()=>this.play()).catch(t=>{console.error("自動再生に失敗しました:",t)})}async preload(){if(!this.isReady){this.preloadPromise||(this.preloadPromise=Promise.all(this.options.imageNames.map(e=>o(this,i,y).call(this,e))));try{this.preloadedImages=await this.preloadPromise,this.isReady=!0,this.preloadedImages.length&&o(this,i,l).call(this,0)}catch(e){throw this.preloadPromise=null,e}}}async play(){if(!this.isPlaying){if(await o(this,i,g).call(this),!this.preloadedImages.length){console.warn("再生可能な画像が見つかりません。");return}this.isPlaying=!0,o(this,i,l).call(this,this.currentIndex),this.timerId=window.setInterval(()=>{o(this,i,f).call(this)},this.options.interval)}}pause(){this.isPlaying&&(this.timerId!==null&&(clearInterval(this.timerId),this.timerId=null),this.isPlaying=!1)}stop(){this.pause(),this.currentIndex=0,this.isReady&&this.preloadedImages.length?o(this,i,l).call(this,0):this.imageEl.removeAttribute("src")}setSpeed(e){if(!Number.isFinite(e)||e<=0){console.warn("setSpeed: 正の数値を指定してください。");return}this.options.interval=e,this.isPlaying&&(this.pause(),this.play().catch(t=>{console.error("再生速度変更後の再生に失敗しました:",t)}))}setLoop(e){this.options.loop=!!e}dispose(){this.stop(),this.mountEl.innerHTML="",this.preloadedImages=[],this.preloadPromise=null,this.isReady=!1}}i=new WeakSet,g=async function(){this.isReady||await this.preload()},f=function(){if(!this.preloadedImages.length)return;let e=this.currentIndex+1;if(e>=this.preloadedImages.length)if(this.options.loop)e=0;else{this.pause();return}this.currentIndex=e,o(this,i,l).call(this,this.currentIndex)},l=function(e){this.preloadedImages[e]&&(this.currentIndex=e,this.imageEl.src=this.preloadedImages[e].src)},y=function(e){const t=o(this,i,I).call(this,e);return new Promise((h,s)=>{const r=new Image;r.decoding="async",r.onload=async()=>{try{typeof r.decode=="function"&&await r.decode()}catch(a){console.warn("decode に失敗しましたが処理を継続します:",a)}h(r)},r.onerror=()=>s(new Error("画像の読み込みに失敗しました: ".concat(t))),r.src=t})},I=function(e){return"".concat(this.options.publicPath).concat(e,".").concat(this.options.extension)},P=function(e){const t={...c,...e||{}};return t.publicPath=o(this,i,E).call(this,t.publicPath),t.interval=o(this,i,b).call(this,t.interval),t},w=function(e){if(!e.mountId)throw new Error("mountId を指定してください。");if(!Array.isArray(e.imageNames)||e.imageNames.length===0)throw new Error("imageNames には1件以上のファイル名を指定してください。");if(!e.extension)throw new Error("extension を指定してください。")},E=function(e){return typeof e!="string"||e.length===0?c.publicPath:e.endsWith("/")?e:"".concat(e,"/")},b=function(e){const t=Number(e);return!Number.isFinite(t)||t<=0?c.interval:t};const N=Array.from({length:101},(n,e)=>"takasaki_".concat(String(e).padStart(4,"0"))),p=new x({mountId:"player",imageNames:N,extension:"jpeg",interval:80,loop:!0,publicPath:"/imgs/",autoPlay:!1}),d=document.getElementById("play-button");d&&d.addEventListener("click",async()=>{d.disabled=!0;try{await p.preload(),await p.play()}catch(n){console.error("再生に失敗しました:",n)}finally{d.disabled=!1}});export{O as __vite_legacy_guard};

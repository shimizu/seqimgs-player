System.register([],function(e,t){"use strict";return{execute:function(){var e=document.createElement("style");e.textContent=":root{font-family:system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,sans-serif;background-color:#f6f8fa;color:#1f2328}body{margin:0;min-height:100vh}.demo{max-width:960px;margin:0 auto;padding:48px 24px 64px;display:flex;flex-direction:column;gap:32px}.demo__header h1{margin:0 0 8px;font-size:2.2rem}.demo__lead{margin:0;line-height:1.6}.demo__controls{display:flex;flex-wrap:wrap;gap:12px}.demo__controls button{padding:10px 18px;border-radius:6px;border:1px solid #c3d0e0;background:#fff;color:inherit;font-size:1rem}.demo__controls button:hover:not(:disabled){background-color:#e9eff7}.demo__controls button:disabled{cursor:wait;opacity:.6}.demo__player{display:flex;justify-content:center}.demo__viewport{width:min(100%,520px);aspect-ratio:4/3;background:#111;border-radius:12px;border:1px solid #202020;overflow:hidden;display:grid;place-items:center}.demo__viewport img{width:100%;height:100%;object-fit:contain;background:#111}.demo__notes ul{margin:0;padding-left:20px;line-height:1.6}.demo__notes li+li{margin-top:6px}.demo__footer{font-size:.9rem;color:#4a5568}\n/*$vite$:1*/",document.head.appendChild(e);const t={extension:"jpeg",interval:100,loop:!0,publicPath:"/imgs/",autoPlay:!0},i=Array.from({length:101},(e,t)=>`takasaki_${String(t).padStart(4,"0")}`),o=new class{constructor(e){if(this.options=this.#e(e),this.#t(this.options),this.mountEl=document.getElementById(this.options.mountId),!this.mountEl)throw new Error(`mountId="${this.options.mountId}" の要素が見つかりません。`);this.imageEl=document.createElement("img"),this.imageEl.decoding="async",this.imageEl.loading="eager",this.mountEl.innerHTML="",this.mountEl.appendChild(this.imageEl),this.currentIndex=0,this.isPlaying=!1,this.isReady=!1,this.timerId=null,this.preloadPromise=null,this.preloadedImages=[],this.options.autoPlay&&this.preload().then(()=>this.play()).catch(e=>{console.error("自動再生に失敗しました:",e)})}async preload(){if(!this.isReady){this.preloadPromise||(this.preloadPromise=Promise.all(this.options.imageNames.map(e=>this.#i(e))));try{this.preloadedImages=await this.preloadPromise,this.isReady=!0,this.preloadedImages.length&&this.#o(0)}catch(e){throw this.preloadPromise=null,e}}}async play(){this.isPlaying||(await this.#n(),this.preloadPromise&&await this.preloadPromise,this.preloadedImages.length?(this.isPlaying=!0,this.#o(this.currentIndex),this.timerId=window.setInterval(()=>{this.#s()},this.options.interval)):console.warn("再生可能な画像が見つかりません。"))}pause(){this.isPlaying&&(null!==this.timerId&&(clearInterval(this.timerId),this.timerId=null),this.isPlaying=!1)}stop(){this.pause(),this.currentIndex=0,this.isReady&&this.preloadedImages.length?this.#o(0):this.imageEl.removeAttribute("src")}setSpeed(e){!Number.isFinite(e)||e<=0?console.warn("setSpeed: 正の数値を指定してください。"):(this.options.interval=e,this.isPlaying&&(this.pause(),this.play().catch(e=>{console.error("再生速度変更後の再生に失敗しました:",e)})))}setLoop(e){this.options.loop=Boolean(e)}dispose(){this.stop(),this.mountEl.innerHTML="",this.preloadedImages=[],this.preloadPromise=null,this.isReady=!1}async#n(){this.isReady||await this.preload()}#s(){if(!this.preloadedImages.length)return;let e=this.currentIndex+1;if(e>=this.preloadedImages.length){if(!this.options.loop)return void this.pause();e=0}this.currentIndex=e,this.#o(this.currentIndex)}#o(e){this.preloadedImages[e]&&(this.currentIndex=e,this.imageEl.src=this.preloadedImages[e].src)}#i(e){const t=this.#a(e);return new Promise((e,i)=>{const o=new Image;o.decoding="async",o.onload=async()=>{try{"function"==typeof o.decode&&await o.decode()}catch(t){console.warn("decode に失敗しましたが処理を継続します:",t)}e(o)},o.onerror=()=>i(new Error(`画像の読み込みに失敗しました: ${t}`)),o.src=t})}#a(e){return`${this.options.publicPath}${e}.${this.options.extension}`}#e(e){const i={...t,...e||{}};return i.publicPath=this.#r(i.publicPath),i.interval=this.#l(i.interval),i}#t(e){if(!e.mountId)throw new Error("mountId を指定してください。");if(!Array.isArray(e.imageNames)||0===e.imageNames.length)throw new Error("imageNames には1件以上のファイル名を指定してください。");if(!e.extension)throw new Error("extension を指定してください。")}#r(e){return"string"!=typeof e||0===e.length?t.publicPath:e.endsWith("/")?e:`${e}/`}#l(e){const i=Number(e);return!Number.isFinite(i)||i<=0?t.interval:i}}({mountId:"player",imageNames:i,extension:"jpeg",interval:80,loop:!0,publicPath:"./imgs/",autoPlay:!1});function n(e,t){const i=document.getElementById(e);i instanceof HTMLButtonElement?t(i):console.warn(`${e} ボタンが見つかりませんでした。`)}n("preload-button",e=>{e.addEventListener("click",async()=>{e.disabled=!0;const t=e.textContent??"プリロード";e.textContent="プリロード中...";try{await o.preload(),e.textContent="プリロード完了"}catch(i){console.error("プリロードに失敗しました:",i),e.textContent="プリロード失敗"}finally{setTimeout(()=>{e.textContent=t,e.disabled=!1},600)}})}),n("play-button",e=>{e.addEventListener("click",async()=>{e.disabled=!0;const t=e.textContent??"再生";e.textContent="再生準備中...";try{await o.play(),e.textContent="再生中"}catch(i){console.error("再生に失敗しました:",i),e.textContent="再生失敗"}finally{setTimeout(()=>{e.textContent=t,e.disabled=!1},400)}})}),n("pause-button",e=>{e.addEventListener("click",()=>{o.pause()})}),n("stop-button",e=>{e.addEventListener("click",()=>{o.stop()})})}}});

var c=n=>{throw TypeError(n)};var E=(n,e,t)=>e.has(n)||c("Cannot "+t);var u=(n,e,t)=>e.has(n)?c("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t);var o=(n,e,t)=>(E(n,e,"access private method"),t);function N(){import.meta.url,import("_").catch(()=>1),(async function*(){})().next()}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();const h={extension:"jpeg",interval:100,loop:!0,publicPath:"/imgs/",autoPlay:!0};var i,m,p,d,f,g,y,I,P,w;class b{constructor(e){u(this,i);if(this.options=o(this,i,y).call(this,e),o(this,i,I).call(this,this.options),this.mountEl=document.getElementById(this.options.mountId),!this.mountEl)throw new Error('mountId="'.concat(this.options.mountId,'" の要素が見つかりません。'));this.imageEl=document.createElement("img"),this.imageEl.decoding="async",this.imageEl.loading="eager",this.mountEl.innerHTML="",this.mountEl.appendChild(this.imageEl),this.currentIndex=0,this.isPlaying=!1,this.isReady=!1,this.timerId=null,this.preloadPromise=null,this.preloadedImages=[],this.options.autoPlay&&this.preload().then(()=>this.play()).catch(t=>{console.error("自動再生に失敗しました:",t)})}async preload(){if(!this.isReady){this.preloadPromise||(this.preloadPromise=Promise.all(this.options.imageNames.map(e=>o(this,i,f).call(this,e))));try{this.preloadedImages=await this.preloadPromise,this.isReady=!0,this.preloadedImages.length&&o(this,i,d).call(this,0)}catch(e){throw this.preloadPromise=null,e}}}async play(){if(!this.isPlaying){if(await o(this,i,m).call(this),this.preloadPromise&&await this.preloadPromise,!this.preloadedImages.length){console.warn("再生可能な画像が見つかりません。");return}this.isPlaying=!0,o(this,i,d).call(this,this.currentIndex),this.timerId=window.setInterval(()=>{o(this,i,p).call(this)},this.options.interval)}}pause(){this.isPlaying&&(this.timerId!==null&&(clearInterval(this.timerId),this.timerId=null),this.isPlaying=!1)}stop(){this.pause(),this.currentIndex=0,this.isReady&&this.preloadedImages.length?o(this,i,d).call(this,0):this.imageEl.removeAttribute("src")}setSpeed(e){if(!Number.isFinite(e)||e<=0){console.warn("setSpeed: 正の数値を指定してください。");return}this.options.interval=e,this.isPlaying&&(this.pause(),this.play().catch(t=>{console.error("再生速度変更後の再生に失敗しました:",t)}))}setLoop(e){this.options.loop=!!e}dispose(){this.stop(),this.mountEl.innerHTML="",this.preloadedImages=[],this.preloadPromise=null,this.isReady=!1}}i=new WeakSet,m=async function(){this.isReady||await this.preload()},p=function(){if(!this.preloadedImages.length)return;let e=this.currentIndex+1;if(e>=this.preloadedImages.length)if(this.options.loop)e=0;else{this.pause();return}this.currentIndex=e,o(this,i,d).call(this,this.currentIndex)},d=function(e){this.preloadedImages[e]&&(this.currentIndex=e,this.imageEl.src=this.preloadedImages[e].src)},f=function(e){const t=o(this,i,g).call(this,e);return new Promise((a,r)=>{const s=new Image;s.decoding="async",s.onload=async()=>{try{typeof s.decode=="function"&&await s.decode()}catch(l){console.warn("decode に失敗しましたが処理を継続します:",l)}a(s)},s.onerror=()=>r(new Error("画像の読み込みに失敗しました: ".concat(t))),s.src=t})},g=function(e){return"".concat(this.options.publicPath).concat(e,".").concat(this.options.extension)},y=function(e){const t={...h,...e||{}};return t.publicPath=o(this,i,P).call(this,t.publicPath),t.interval=o(this,i,w).call(this,t.interval),t},I=function(e){if(!e.mountId)throw new Error("mountId を指定してください。");if(!Array.isArray(e.imageNames)||e.imageNames.length===0)throw new Error("imageNames には1件以上のファイル名を指定してください。");if(!e.extension)throw new Error("extension を指定してください。")},P=function(e){return typeof e!="string"||e.length===0?h.publicPath:e.endsWith("/")?e:"".concat(e,"/")},w=function(e){const t=Number(e);return!Number.isFinite(t)||t<=0?h.interval:t};async function v(){const n=Array.from({length:101},(a,r)=>"takasaki_".concat(String(r).padStart(4,"0"))),e=new b({mountId:"player",imageNames:n,extension:"jpeg",interval:80,loop:!0,publicPath:"/imgs/",autoPlay:!1});await e.preload();const t=document.getElementById("play-button");t&&t.addEventListener("click",async()=>{t.disabled=!0;try{await e.preload(),await e.play()}catch(a){console.error("再生に失敗しました:",a)}finally{t.disabled=!1}})}v();export{N as __vite_legacy_guard};
